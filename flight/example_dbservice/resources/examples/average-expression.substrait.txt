extension_uris {
  extension_uri_anchor: 1
}
extensions {
  extension_function {
    extension_uri_reference: 1
    function_anchor: 1
    name: "count"
  }
}
extensions {
  extension_function {
    extension_uri_reference: 1
    function_anchor: 2
    name: "sum"
  }
}
extensions {
  extension_function {
    extension_uri_reference: 1
    function_anchor: 3
    name: "equal"
  }
}
extensions {
  extension_function {
    extension_uri_reference: 1
    function_anchor: 4
    name: "coalesce"
  }
}
extensions {
  extension_function {
    extension_uri_reference: 1
    function_anchor: 5
    name: "add"
  }
}
extensions {
  extension_function {
    extension_uri_reference: 1
    function_anchor: 6
    name: "divide"
  }
}
relations {
  root {
    input {
      project {
        common {
          emit {
            output_mapping: 3
            output_mapping: 4
          }
        }
        input {
          project {
            common {
              emit {
                output_mapping: 12
                output_mapping: 13
                output_mapping: 14
              }
            }
            input {
              join {
                left {
                  project {
                    common {
                      emit {
                        output_mapping: 9
                        output_mapping: 10
                        output_mapping: 11
                      }
                    }
                    input {
                      join {
                        left {
                          project {
                            common {
                              emit {
                                output_mapping: 6
                                output_mapping: 7
                                output_mapping: 8
                              }
                            }
                            input {
                              join {
                                left {
                                  aggregate {
                                    input {
                                      read {
                                        common {
                                          direct {
                                          }
                                        }
                                        base_schema {
                                          names: "gene_id"
                                          names: "cell_id"
                                          names: "expression"
                                          struct {
                                            types {
                                              string {
                                                nullability: NULLABILITY_NULLABLE
                                              }
                                            }
                                            types {
                                              string {
                                                nullability: NULLABILITY_NULLABLE
                                              }
                                            }
                                            types {
                                              fp32 {
                                                nullability: NULLABILITY_NULLABLE
                                              }
                                            }
                                            nullability: NULLABILITY_REQUIRED
                                          }
                                        }
                                        named_table {
                                          names: "test/sample;0"
                                        }
                                      }
                                    }
                                    groupings {
                                      grouping_expressions {
                                        selection {
                                          direct_reference {
                                            struct_field {
                                            }
                                          }
                                          root_reference {
                                          }
                                        }
                                      }
                                    }
                                    measures {
                                      measure {
                                        function_reference: 1
                                        phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                                        output_type {
                                          i64 {
                                            nullability: NULLABILITY_NULLABLE
                                          }
                                        }
                                      }
                                    }
                                    measures {
                                      measure {
                                        function_reference: 2
                                        phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                                        output_type {
                                          fp64 {
                                            nullability: NULLABILITY_NULLABLE
                                          }
                                        }
                                        arguments {
                                          value {
                                            selection {
                                              direct_reference {
                                                struct_field {
                                                  field: 2
                                                }
                                              }
                                              root_reference {
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                                right {
                                  aggregate {
                                    input {
                                      read {
                                        common {
                                          direct {
                                          }
                                        }
                                        base_schema {
                                          names: "gene_id"
                                          names: "cell_id"
                                          names: "expression"
                                          struct {
                                            types {
                                              string {
                                                nullability: NULLABILITY_NULLABLE
                                              }
                                            }
                                            types {
                                              string {
                                                nullability: NULLABILITY_NULLABLE
                                              }
                                            }
                                            types {
                                              fp32 {
                                                nullability: NULLABILITY_NULLABLE
                                              }
                                            }
                                            nullability: NULLABILITY_REQUIRED
                                          }
                                        }
                                        named_table {
                                          names: "test/sample;1"
                                        }
                                      }
                                    }
                                    groupings {
                                      grouping_expressions {
                                        selection {
                                          direct_reference {
                                            struct_field {
                                            }
                                          }
                                          root_reference {
                                          }
                                        }
                                      }
                                    }
                                    measures {
                                      measure {
                                        function_reference: 1
                                        phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                                        output_type {
                                          i64 {
                                            nullability: NULLABILITY_NULLABLE
                                          }
                                        }
                                      }
                                    }
                                    measures {
                                      measure {
                                        function_reference: 2
                                        phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                                        output_type {
                                          fp64 {
                                            nullability: NULLABILITY_NULLABLE
                                          }
                                        }
                                        arguments {
                                          value {
                                            selection {
                                              direct_reference {
                                                struct_field {
                                                  field: 2
                                                }
                                              }
                                              root_reference {
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                                expression {
                                  scalar_function {
                                    function_reference: 3
                                    output_type {
                                      bool {
                                        nullability: NULLABILITY_NULLABLE
                                      }
                                    }
                                    arguments {
                                      value {
                                        selection {
                                          direct_reference {
                                            struct_field {
                                            }
                                          }
                                          root_reference {
                                          }
                                        }
                                      }
                                    }
                                    arguments {
                                      value {
                                        selection {
                                          direct_reference {
                                            struct_field {
                                              field: 3
                                            }
                                          }
                                          root_reference {
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                                type: JOIN_TYPE_OUTER
                              }
                            }
                            expressions {
                              scalar_function {
                                function_reference: 4
                                output_type {
                                  string {
                                    nullability: NULLABILITY_NULLABLE
                                  }
                                }
                              }
                            }
                            expressions {
                              scalar_function {
                                function_reference: 5
                                output_type {
                                  i64 {
                                    nullability: NULLABILITY_NULLABLE
                                  }
                                }
                                arguments {
                                  value {
                                    selection {
                                      direct_reference {
                                        struct_field {
                                          field: 1
                                        }
                                      }
                                      root_reference {
                                      }
                                    }
                                  }
                                }
                                arguments {
                                  value {
                                    selection {
                                      direct_reference {
                                        struct_field {
                                          field: 4
                                        }
                                      }
                                      root_reference {
                                      }
                                    }
                                  }
                                }
                              }
                            }
                            expressions {
                              scalar_function {
                                function_reference: 5
                                output_type {
                                  fp64 {
                                    nullability: NULLABILITY_NULLABLE
                                  }
                                }
                                arguments {
                                  value {
                                    selection {
                                      direct_reference {
                                        struct_field {
                                          field: 2
                                        }
                                      }
                                      root_reference {
                                      }
                                    }
                                  }
                                }
                                arguments {
                                  value {
                                    selection {
                                      direct_reference {
                                        struct_field {
                                          field: 5
                                        }
                                      }
                                      root_reference {
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                        right {
                          aggregate {
                            input {
                              read {
                                common {
                                  direct {
                                  }
                                }
                                base_schema {
                                  names: "gene_id"
                                  names: "cell_id"
                                  names: "expression"
                                  struct {
                                    types {
                                      string {
                                        nullability: NULLABILITY_NULLABLE
                                      }
                                    }
                                    types {
                                      string {
                                        nullability: NULLABILITY_NULLABLE
                                      }
                                    }
                                    types {
                                      fp32 {
                                        nullability: NULLABILITY_NULLABLE
                                      }
                                    }
                                    nullability: NULLABILITY_REQUIRED
                                  }
                                }
                                named_table {
                                  names: "test/sample;2"
                                }
                              }
                            }
                            groupings {
                              grouping_expressions {
                                selection {
                                  direct_reference {
                                    struct_field {
                                    }
                                  }
                                  root_reference {
                                  }
                                }
                              }
                            }
                            measures {
                              measure {
                                function_reference: 1
                                phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                                output_type {
                                  i64 {
                                    nullability: NULLABILITY_NULLABLE
                                  }
                                }
                              }
                            }
                            measures {
                              measure {
                                function_reference: 2
                                phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                                output_type {
                                  fp64 {
                                    nullability: NULLABILITY_NULLABLE
                                  }
                                }
                                arguments {
                                  value {
                                    selection {
                                      direct_reference {
                                        struct_field {
                                          field: 2
                                        }
                                      }
                                      root_reference {
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                        expression {
                          scalar_function {
                            function_reference: 3
                            output_type {
                              bool {
                                nullability: NULLABILITY_NULLABLE
                              }
                            }
                            arguments {
                              value {
                                selection {
                                  direct_reference {
                                    struct_field {
                                    }
                                  }
                                  root_reference {
                                  }
                                }
                              }
                            }
                            arguments {
                              value {
                                selection {
                                  direct_reference {
                                    struct_field {
                                      field: 3
                                    }
                                  }
                                  root_reference {
                                  }
                                }
                              }
                            }
                          }
                        }
                        type: JOIN_TYPE_OUTER
                      }
                    }
                    expressions {
                      scalar_function {
                        function_reference: 4
                        output_type {
                          string {
                            nullability: NULLABILITY_NULLABLE
                          }
                        }
                      }
                    }
                    expressions {
                      scalar_function {
                        function_reference: 5
                        output_type {
                          i64 {
                            nullability: NULLABILITY_NULLABLE
                          }
                        }
                        arguments {
                          value {
                            selection {
                              direct_reference {
                                struct_field {
                                  field: 1
                                }
                              }
                              root_reference {
                              }
                            }
                          }
                        }
                        arguments {
                          value {
                            selection {
                              direct_reference {
                                struct_field {
                                  field: 4
                                }
                              }
                              root_reference {
                              }
                            }
                          }
                        }
                      }
                    }
                    expressions {
                      scalar_function {
                        function_reference: 5
                        output_type {
                          fp64 {
                            nullability: NULLABILITY_NULLABLE
                          }
                        }
                        arguments {
                          value {
                            selection {
                              direct_reference {
                                struct_field {
                                  field: 2
                                }
                              }
                              root_reference {
                              }
                            }
                          }
                        }
                        arguments {
                          value {
                            selection {
                              direct_reference {
                                struct_field {
                                  field: 5
                                }
                              }
                              root_reference {
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
                right {
                  aggregate {
                    input {
                      read {
                        common {
                          direct {
                          }
                        }
                        base_schema {
                          names: "gene_id"
                          names: "cell_id"
                          names: "expression"
                          struct {
                            types {
                              string {
                                nullability: NULLABILITY_NULLABLE
                              }
                            }
                            types {
                              string {
                                nullability: NULLABILITY_NULLABLE
                              }
                            }
                            types {
                              fp32 {
                                nullability: NULLABILITY_NULLABLE
                              }
                            }
                            nullability: NULLABILITY_REQUIRED
                          }
                        }
                        named_table {
                          names: "test/sample;3"
                        }
                      }
                    }
                    groupings {
                      grouping_expressions {
                        selection {
                          direct_reference {
                            struct_field {
                            }
                          }
                          root_reference {
                          }
                        }
                      }
                    }
                    measures {
                      measure {
                        function_reference: 1
                        phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                        output_type {
                          i64 {
                            nullability: NULLABILITY_NULLABLE
                          }
                        }
                      }
                    }
                    measures {
                      measure {
                        function_reference: 2
                        phase: AGGREGATION_PHASE_INITIAL_TO_RESULT
                        output_type {
                          fp64 {
                            nullability: NULLABILITY_NULLABLE
                          }
                        }
                        arguments {
                          value {
                            selection {
                              direct_reference {
                                struct_field {
                                  field: 2
                                }
                              }
                              root_reference {
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
                expression {
                  scalar_function {
                    function_reference: 3
                    output_type {
                      bool {
                        nullability: NULLABILITY_NULLABLE
                      }
                    }
                    arguments {
                      value {
                        selection {
                          direct_reference {
                            struct_field {
                            }
                          }
                          root_reference {
                          }
                        }
                      }
                    }
                    arguments {
                      value {
                        selection {
                          direct_reference {
                            struct_field {
                              field: 3
                            }
                          }
                          root_reference {
                          }
                        }
                      }
                    }
                  }
                }
                type: JOIN_TYPE_OUTER
              }
            }
            expressions {
              scalar_function {
                function_reference: 4
                output_type {
                  string {
                    nullability: NULLABILITY_NULLABLE
                  }
                }
              }
            }
            expressions {
              scalar_function {
                function_reference: 5
                output_type {
                  i64 {
                    nullability: NULLABILITY_NULLABLE
                  }
                }
                arguments {
                  value {
                    selection {
                      direct_reference {
                        struct_field {
                          field: 1
                        }
                      }
                      root_reference {
                      }
                    }
                  }
                }
                arguments {
                  value {
                    selection {
                      direct_reference {
                        struct_field {
                          field: 4
                        }
                      }
                      root_reference {
                      }
                    }
                  }
                }
              }
            }
            expressions {
              scalar_function {
                function_reference: 5
                output_type {
                  fp64 {
                    nullability: NULLABILITY_NULLABLE
                  }
                }
                arguments {
                  value {
                    selection {
                      direct_reference {
                        struct_field {
                          field: 2
                        }
                      }
                      root_reference {
                      }
                    }
                  }
                }
                arguments {
                  value {
                    selection {
                      direct_reference {
                        struct_field {
                          field: 5
                        }
                      }
                      root_reference {
                      }
                    }
                  }
                }
              }
            }
          }
        }
        expressions {
          selection {
            direct_reference {
              struct_field {
              }
            }
            root_reference {
            }
          }
        }
        expressions {
          scalar_function {
            function_reference: 6
            output_type {
              fp64 {
                nullability: NULLABILITY_NULLABLE
              }
            }
            arguments {
              value {
                selection {
                  direct_reference {
                    struct_field {
                      field: 2
                    }
                  }
                  root_reference {
                  }
                }
              }
            }
            arguments {
              value {
                selection {
                  direct_reference {
                    struct_field {
                      field: 1
                    }
                  }
                  root_reference {
                  }
                }
              }
            }
          }
        }
      }
    }
    names: "gene_id"
    names: "expr_avg"
  }
}

